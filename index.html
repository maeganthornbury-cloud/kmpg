diff --git a/index.html b/index.html
index 971d625826bbcf9111fff642d171d72d02b862e6..3c0b7fb596c721718d8c535bbe06de830da88ff0 100644
--- a/index.html
+++ b/index.html
@@ -1,42 +1,39 @@
 <!DOCTYPE html>
 <html lang="en">
 <head><meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1">
   <title>Kentucky Mirror and Plate Glass - New Order</title>
   <style>
     body { font-family: Arial, sans-serif; margin: 20px; }
     h1 { text-align: center; }
     .container { display: flex; }
     .section { width: 50%; padding: 10px; }
     table { width: 100%; border-collapse: collapse; }
     th, td { border: 1px solid #ccc; padding: 12px; text-align: center; }
     input, select { width: 90%; }
     .buttons { margin-top: 15px; }
-    #hardwareList { overflow-y: auto; max-height: 200px; border: 1px solid #ccc; padding: 5px; list-style: none; }
-    #hardwareList li { cursor: pointer; margin: 5px 0; }
-    #hardwareDropdownBtn { margin-left: 5px; }
 
 .glassList li.active {
   background-color: #cce5ff;
 }
     .glassTypeInput {
       width: 100%;
       max-width: 750px;
       height: 12px;
       font-size: 16px;
       padding: 1px;
     }
 
     .glassList {
       position: absolute;
       background: #fff;
       border: 1px solid #ccc;
       max-height: 200px;
       overflow-y: auto;
       list-style: none;
       padding: 0;
       margin-top: 2px;
       display: none;
       z-index: 1000;
     }
     .glassList li {
@@ -813,161 +810,86 @@ body{
           <span class="kympg-hint">Find past orders</span>
         </span>
       </button>
 
       <button class="kympg-navBtn" data-tip="Open Quotes" type="button" onclick="kympgOpen('quotedb', this)">
         <span class="kympg-ico" aria-hidden="true">
           <svg viewBox="0 0 24 24"><path d="M7 7h10"/><path d="M7 11h10"/><path d="M7 15h6"/><path d="M6 3h12a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"/></svg>
         </span>
         <span class="kympg-labelWrap">
           <span class="kympg-label">Open Quotes</span>
           <span class="kympg-hint">Saved quotes</span>
         </span>
       </button>
 
       <button class="kympg-navBtn" data-tip="Purchase Orders" type="button" onclick="kympgOpen('po', this)">
         <span class="kympg-ico" aria-hidden="true">
           <svg viewBox="0 0 24 24"><path d="M3 3h18v4H3z"/><path d="M3 7v14h18V7"/></svg>
         </span>
         <span class="kympg-labelWrap">
           <span class="kympg-label">Purchase Orders</span>
           <span class="kympg-hint">Vendor POs</span>
         </span>
       </button>
     </nav>
 
-    <div class="kympg-sectionLabel">Tools</div>
-    <nav class="kympg-nav">
-      <button class="kympg-navBtn" data-tip="Breakage Pricing" type="button" onclick="kympgOpen('breakage', this)">
-        <span class="kympg-ico" aria-hidden="true">
-          <svg viewBox="0 0 24 24"><path d="M12 3v18"/><path d="M3 12h18"/></svg>
-        </span>
-        <span class="kympg-labelWrap">
-          <span class="kympg-label">Breakage Pricing</span>
-          <span class="kympg-hint">Open breakage tool</span>
-        </span>
-      </button>
-
-      <button class="kympg-navBtn" data-tip="Sq Ft Price List" type="button" onclick="kympgOpen('pricelist', this)">
-        <span class="kympg-ico" aria-hidden="true">
-          <svg viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/></svg>
-        </span>
-        <span class="kympg-labelWrap">
-          <span class="kympg-label">Sq Ft Price List</span>
-          <span class="kympg-hint">Reference pricing</span>
-        </span>
-      </button>
-    </nav>
-        </span>
-      </button>
-    </nav>
-
     <div class="kympg-sectionLabel">Tools</div>
     <nav class="kympg-nav">
       <button class="kympg-navBtn" data-tip="Breakage Pricing" type="button" onclick="kympgOpen('breakage', this)">
         <span class="kympg-ico" aria-hidden="true">
           <svg viewBox="0 0 24 24"><path d="M12 3v18"/><path d="M3 12h18"/></svg>
         </span>
         <span class="kympg-labelWrap">
           <span class="kympg-label">Breakage Pricing</span>
           <span class="kympg-hint">Open breakage tool</span>
         </span>
       </button>
 
       <button class="kympg-navBtn" data-tip="Sq Ft Price List" type="button" onclick="kympgOpen('pricelist', this)">
         <span class="kympg-ico" aria-hidden="true">
           <svg viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/></svg>
         </span>
         <span class="kympg-labelWrap">
           <span class="kympg-label">Sq Ft Price List</span>
           <span class="kympg-hint">Reference pricing</span>
         </span>
       </button>
 
       <button class="kympg-navBtn" data-tip="Customer Import" type="button" onclick="kympgOpen('customerimport', this)">
         <span class="kympg-ico" aria-hidden="true">
           <svg viewBox="0 0 24 24"><path d="M3 6h18"/><path d="M3 12h18"/><path d="M3 18h18"/><path d="M17 10l4 4-4 4"/><path d="M21 14H9"/></svg>
         </span>
         <span class="kympg-labelWrap">
           <span class="kympg-label">Customer Import</span>
           <span class="kympg-hint">Upload customer list</span>
         </span>
       </button>
     </nav>
 
     <div class="kympg-spacer"></div>
   </aside>
 
-  <main class="kympg-main">
-    <div class="kympg-shellInner">
-      <div class="kympg-topBar">
-        <div class="kympg-pageTitle">
-          <h1 id="kympgPageTitle">Kentucky Mirror and Plate Glass</h1>
-          <p id="kympgPageSub">Select an option on the left to get started.</p>
-        </div>
-        <div class="kympg-pill" title="App status">
-          <span class="dot"></span>
-          <span>Ready</span>
-        </div>
-      </div>
-
-      <section class="kympg-card">
-        <div class="kympg-cardHeader">
-          <div class="h" id="kympgCardTitle">Home</div>
-          <div class="sub" id="kympgCardSub">Welcome</div>
-        </div>
-        <div class="kympg-cardBody" id="kympgContentArea">
-          <div id="landing-section" class="active">
-@@ -3061,45 +3071,52 @@ document.addEventListener("DOMContentLoaded", async function () {
-  const p = document.getElementById('po-section');
-  if (p){ p.style.display = 'block'; }
-
-  kympgSetHeader(
-    'Purchase Orders',
-    'Track vendor purchase orders.',
-    'Purchase Orders',
-    'Vendor POs'
-  );
-
-  loadPurchaseOrders();   // ‚Üê THIS LINE loads the database
-  return;
-}
-    if (which === 'breakage'){
-      const b = document.getElementById('breakage-section');
-      if (b){ b.style.display = 'block'; }
-      kympgSetHeader('Breakage Pricing', 'Open the breakage calculator inside the app.', 'Breakage Pricing', 'Tool');
-      return;
-    }
-    if (which === 'pricelist'){
-      const p = document.getElementById('pricelist-section');
-      if (p){ p.style.display = 'block'; }
-      kympgSetHeader('Sq Ft Price List', 'Reference pricing inside the app.', 'Sq Ft Price List', 'Tool');
-      return;
-    }
-    <div class="kympg-spacer"></div>
-  </aside>
-
   <main class="kympg-main">
     <div class="kympg-shellInner">
       <div class="kympg-topBar">
         <div class="kympg-pageTitle">
           <h1 id="kympgPageTitle">Kentucky Mirror and Plate Glass</h1>
           <p id="kympgPageSub">Select an option on the left to get started.</p>
         </div>
         <div class="kympg-pill" title="App status">
           <span class="dot"></span>
           <span>Ready</span>
         </div>
       </div>
 
       <section class="kympg-card">
         <div class="kympg-cardHeader">
           <div class="h" id="kympgCardTitle">Home</div>
           <div class="sub" id="kympgCardSub">Welcome</div>
         </div>
         <div class="kympg-cardBody" id="kympgContentArea">
           <div id="landing-section" class="active">
             <div class="kympg-landingWrap">
               <div class="kympg-landingLogo">
                 <img src="564e4083-db27-4742-b925-737f1faaa333.jpg" alt="Kentucky Mirror and Plate Glass" onerror="this.style.display='none';" />
               </div>
               <div class="kympg-landingTitle">Kentucky Mirror and Plate Glass</div>
@@ -1084,58 +1006,96 @@ body{
           <th>Bevel?</th>
           <th>Bevel Width</th>
           <th>Shape?</th>
           <th>Each Price ($)</th>
           <th>Line Total ($)</th>
           <th>Delete</th>
         </tr>
       </thead>
       <tbody id="glassTableBody"></tbody>
     </table>
 
     <div class="buttons">
       <button class="btn-save-order" onclick="saveOrder()">Save Order</button>
       <button class="btn-new-order" onclick="startNewOrder()">New Order</button>
       <button onclick="addRow()">Add Line</button>
       <button type="button" onclick="printDoc('quote')">Print Quote</button>
 <button type="button" onclick="printDoc('ticket')">Print Ticket</button>
 <button type="button" onclick="printDoc('invoice')">Print Invoice</button>
     </div>
 
     <h3 id="grandTotal">Grand Total: $0.00</h3>
     <h3 id="grandTotalTax">Grand Total with Tax (6%): $0.00</h3>
   </div>
 
   <!-- Hardware Pricing Section -->
-  <div style="flex: 1;">
-    <h2 style="margin-top: 10px;">Misc Hardware Pricing</h2>
-    <div id="hardwareDropdown" class="dropdown-container">
-      <input id="hardwareSearch" type="text" placeholder="Search hardware..." />
-      <button id="hardwareDropdownBtn" type="button">&#9662;</button>
-      <ul id="hardwareList" class="dropdown-list"></ul>
-    </div>
-    <h3 id="hardwarePrice">Hardware Price: $0.00</h3>
+  <div style="flex: 1; margin-top: 16px;">
+    <h2 style="margin-top: 10px; text-align:left;">Misc Hardware Pricing</h2>
+    <table id="hardwareTable">
+      <thead>
+        <tr>
+          <th>Qty</th>
+          <th>Part</th>
+          <th>Price</th>
+          <th>Total</th>
+        </tr>
+      </thead>
+      <tbody id="hardwareTableBody">
+        <tr>
+          <td><input type="number" class="hw-qty" min="0" value="0" style="width:70px;"></td>
+          <td><input type="text" class="hw-part" placeholder="Type to search part..." list="hardwarePartsList"></td>
+          <td class="hw-price">$0.00</td>
+          <td class="hw-total">$0.00</td>
+        </tr>
+        <tr>
+          <td><input type="number" class="hw-qty" min="0" value="0" style="width:70px;"></td>
+          <td><input type="text" class="hw-part" placeholder="Type to search part..." list="hardwarePartsList"></td>
+          <td class="hw-price">$0.00</td>
+          <td class="hw-total">$0.00</td>
+        </tr>
+        <tr>
+          <td><input type="number" class="hw-qty" min="0" value="0" style="width:70px;"></td>
+          <td><input type="text" class="hw-part" placeholder="Type to search part..." list="hardwarePartsList"></td>
+          <td class="hw-price">$0.00</td>
+          <td class="hw-total">$0.00</td>
+        </tr>
+        <tr>
+          <td><input type="number" class="hw-qty" min="0" value="0" style="width:70px;"></td>
+          <td><input type="text" class="hw-part" placeholder="Type to search part..." list="hardwarePartsList"></td>
+          <td class="hw-price">$0.00</td>
+          <td class="hw-total">$0.00</td>
+        </tr>
+        <tr>
+          <td><input type="number" class="hw-qty" min="0" value="0" style="width:70px;"></td>
+          <td><input type="text" class="hw-part" placeholder="Type to search part..." list="hardwarePartsList"></td>
+          <td class="hw-price">$0.00</td>
+          <td class="hw-total">$0.00</td>
+        </tr>
+      </tbody>
+    </table>
+    <datalist id="hardwarePartsList"></datalist>
+    <h3 id="hardwareGrandTotal">Hardware Total: $0.00</h3>
     <button onclick="clearHardware()">Clear Hardware</button>
   </div>
 </div>
 </div><!-- end calculator-section -->
 
 <!-- Customer Management Section -->
 <div id="customer-section">
   <h2>Customer Database</h2>
 
   <div id="customerFormWrapper" style="display:none;">
     <form id="customerForm" onsubmit="saveCustomer(event)">
       <input type="hidden" id="custEditId" value="">
       <h3 id="formTitle">Add New Customer</h3>
 
       <label for="custName">Customer Name *</label>
       <input type="text" id="custName" required placeholder="Enter customer name">
 
       <label for="custAddress">Address</label>
       <input type="text" id="custAddress" placeholder="Enter address">
 
       <label for="custEmail">Email</label>
       <input type="email" id="custEmail" placeholder="Enter email address">
 
       <label for="custPhone">Phone Number</label>
       <input type="tel" id="custPhone" placeholder="(123) 456-7890">
@@ -1368,50 +1328,51 @@ function setLoadingState(isLoading, msg) {
 
 async function loadPricingFromSheets() {
   // If URLs are not set yet, keep existing maps empty and allow user to still use UI
   const needsSetup = Object.values(SHEET_CSV).some(u => !u || u.includes("PASTE_"));
   if (needsSetup) {
     console.warn("Google Sheet CSV links not set yet in SHEET_CSV. Pricing tables will be empty until you paste them.");
     return;
   }
 
   setLoadingState(true);
 
   try {
     const [stdText, spText, hwText] = await Promise.all([
       fetchCsv(SHEET_CSV.glassStandard),
       fetchCsv(SHEET_CSV.glassSpecial),
       fetchCsv(SHEET_CSV.hardware)
     ]);
 
     const stdRows = parseCsv(stdText || '');
     const spRows  = parseCsv(spText || '');
     const hwRows  = parseCsv(hwText || '');
 
     standardglassPartsData = rowsToGlassMap(stdRows);
     specialGlassPartsData  = rowsToGlassMap(spRows);
     hardwareParts          = rowsToHardwareMap(hwRows);
+    refreshHardwareDatalist();
 
     // Refresh active pointer after load
     const specialToggle = document.getElementById('specialPricingToggle');
     glassPartsData = (specialToggle && specialToggle.checked) ? specialGlassPartsData : standardglassPartsData;
 
     // Re-render any existing dropdown lists & totals
     updateTotals();
 
   } catch (err) {
     console.error(err);
     alert("Could not load pricing from Google Sheets. Check your published CSV links and that the tabs are published as CSV.");
   } finally {
     setLoadingState(false);
   }
 }
 
 
 // ===================== BEHAVIOR =====================
 
 // Phone formatter
 document.getElementById('customerPhone').addEventListener('input', function (e) {
   let input = e.target.value.replace(/\D/g, '');
   if (input.length > 10) input = input.substring(0, 10);
 
   let formatted = input;
@@ -1522,81 +1483,74 @@ document.getElementById('glassTableBody').addEventListener('click', function(e)
   const typeEl = row.querySelector('.glassTypeInput');
   const bevelEl = row.querySelector('.bevel');
   const bevelWidthEl = row.querySelector('.bevelWidth');
   const shapeEl = row.querySelector('.shape');
   const listEl = row.querySelector('.glassList');
   const eachEl = row.querySelector('.eachPrice');
   const lineEl = row.querySelector('.lineTotal');
 
   if (qtyEl) qtyEl.value = 1;
   if (widthEl) widthEl.value = '';
   if (heightEl) heightEl.value = '';
   if (typeEl) typeEl.value = '';
   if (bevelEl) bevelEl.checked = false;
   if (shapeEl) shapeEl.checked = false;
   if (bevelWidthEl) bevelWidthEl.selectedIndex = 0;
   if (listEl) { listEl.innerHTML = ''; listEl.style.display = 'none'; }
   if (eachEl) eachEl.innerText = '$0.00';
   if (lineEl) lineEl.innerText = '$0.00';
 
   delete row.dataset.bevelAlerted;
   delete row.dataset.plexiAlerted;
 
   updateTotals();
 });
 
-// Hardware search events
-document.getElementById('hardwareSearch').addEventListener('input', showHardwareList);
-document.getElementById('hardwareDropdownBtn').addEventListener('click', toggleHardwareList);
-document.addEventListener('click', function(event) {
-  if (!document.getElementById('hardwareDropdown').contains(event.target)) hideHardwareList();
+// Hardware table events
+document.getElementById('hardwareTableBody').addEventListener('input', function (event) {
+  const row = event.target.closest('tr');
+  if (!row) return;
+  updateHardwareRow(row);
+  updateHardwareTotals();
 });
 
 // ===================== FUNCTIONS =====================
 function parseInput(value) {
   if (!value) return 0;
   value = value.trim();
   if (value.includes(' ')) {
     const parts = value.split(' ');
     const whole = parseFloat(parts[0]);
     const fractionParts = parts[1].split('/');
     return whole + (parseFloat(fractionParts[0]) / parseFloat(fractionParts[1]));
   } else if (value.includes('/')) {
     const fractionParts = value.split('/');
     return parseFloat(fractionParts[0]) / parseFloat(fractionParts[1]);
   } else {
     return parseFloat(value);
   }
 }
-function printDoc(type) {
-  if (!currentOrderId) {
-    alert("Please save the order first, then print.");
-    return;
-  }
-  const url = `/api/orders?id=${encodeURIComponent(currentOrderId)}&print=${encodeURIComponent(type)}`;
-  window.open(url, "_blank");
-}
 function roundEven(num) {
   if (isNaN(num)) return 0;
   let rounded = Math.ceil(num);
   return (rounded % 2 === 0) ? rounded : rounded + 1;
 }
 
 function addRow() {
   const tbody = document.getElementById('glassTableBody');
   const tr = document.createElement('tr');
   tr.innerHTML = `
     <td><input type="number" class="qty" value="1" min="1" style="width: 60px;"></td>
     <td><input type="text" class="width"></td>
     <td><input type="text" class="height"></td>
     <td style="position:relative;">
       <input type="text" class="glassTypeInput largeDropdown" placeholder="Type to search glass...">
       <ul class="glassList"></ul>
     </td>
     <td><input type="checkbox" class="bevel"></td>
     <td>
       <select class="bevelWidth">
         <option value="1/2">1/2"</option>
         <option value="1">1"</option>
         <option value="1 1/4">1 1/4"</option>
       </select>
     </td>
@@ -1714,75 +1668,74 @@ function updateTotals() {
     const glassType = row.querySelector('.glassTypeInput').value;
     const bevelCheckbox = row.querySelector('.bevel');
     const bevelChecked = bevelCheckbox.checked;
     const bevelWidth = row.querySelector('.bevelWidth').value;
     const shapeCheckbox = row.querySelector('.shape');
     const shapeChecked = shapeCheckbox.checked;
 
     if (shapeChecked) {
       bevelCheckbox.checked = false;
     }
 
     if (!glassType || !glassPartsData[glassType]) {
       row.querySelector('.eachPrice').innerText = '$0.00';
       row.querySelector('.lineTotal').innerText = '$0.00';
       return;
     }
 
     let width = roundEven(parseInput(widthInput));
     let height = roundEven(parseInput(heightInput));
     if (isNaN(width) || isNaN(height)) {
       row.querySelector('.eachPrice').innerText = '$0.00';
       row.querySelector('.lineTotal').innerText = '$0.00';
       return;
     }
 
-// PLEXI ‚Äî quote ONLY if the piece cannot be cut from a 48 x 96 sheet (any orientation)
-const isPlexi = glassType.toUpperCase().includes('PLEXI');
-
-if (isPlexi) {
-  const fitsNormal  = width  <= 48 && height <= 96; // 48 x 96
-  const fitsRotated = width  <= 96 && height <= 48; // 96 x 48
+    // PLEXI ‚Äî quote ONLY if the piece cannot be cut from a 48 x 96 sheet (any orientation)
+    const isPlexi = glassType.toUpperCase().includes('PLEXI');
 
-  // If it doesn't fit in either orientation, it must be quoted
-  if (!fitsNormal && !fitsRotated) {
-    row.querySelector('.eachPrice').innerText = '$0.00';
-    row.querySelector('.lineTotal').innerText = 'Must be quoted by General Rubber';
+    if (isPlexi) {
+      const fitsNormal  = width <= 48 && height <= 96; // 48 x 96
+      const fitsRotated = width <= 96 && height <= 48; // 96 x 48
 
-    if (row.dataset.plexiAlerted !== "true") {
-      alert("This size cannot be cut from a 48 x 96 sheet and must be quoted by General Rubber.");
-      row.dataset.plexiAlerted = "true";
-    }
-
-    return; // stop calculations for this row
-  }
+      // If it doesn't fit in either orientation, it must be quoted
+      if (!fitsNormal && !fitsRotated) {
+        row.querySelector('.eachPrice').innerText = '$0.00';
+        row.querySelector('.lineTotal').innerText = 'Must be quoted by General Rubber';
 
+        if (row.dataset.plexiAlerted !== 'true') {
+          alert('This size cannot be cut from a 48 x 96 sheet and must be quoted by General Rubber.');
+          row.dataset.plexiAlerted = 'true';
+        }
 
-// If we get here, the piece fits in 48 x 96 somehow ‚Üí continue with normal pricing...    } else {
-      delete row.dataset.plexiAlerted;
+        return; // stop calculations for this row
+      }
     }
 
+    // If we get here, either it is not plexi, or plexi fits 48x96 in some orientation
+    delete row.dataset.plexiAlerted;
+
     let area = (width * height) / 144;
     const partInfo = glassPartsData[glassType];
 
     // ================= CUSTOM MINIMUM RULE CHANGES =================
     // - Polished tempered: minimum 3 sq ft charge
     // - Polished non-tempered: $15 minimum
     // - Everything else: use partInfo.min
     let basePrice;
 
     const upperType = glassType.toUpperCase();
     const isTempered = upperType.includes("TEMPERED");
     const isPolished = upperType.includes("POLISHED");
 
     // üö® TEMPERED + SHAPE = MUST QUOTE BY GLENNY
 if (isTempered && shapeChecked) {
   row.querySelector('.eachPrice').innerText = '$0.00';
   row.querySelector('.lineTotal').innerText = 'Needs quoted by Glenny';
 
   if (row.dataset.temperedShapeAlerted !== "true") {
     alert("Tempered shapes must be quoted by Glenny.");
     row.dataset.temperedShapeAlerted = "true";
   }
 
   return; // stop calculations for this row
 } else {
@@ -1834,87 +1787,99 @@ if (isTempered && shapeChecked) {
       else if (glassType.includes('3/16')) shapeMin = 25;
       else if (glassType.includes('1/4')) shapeMin = 25;
       else if (glassType.includes('3/8')) shapeMin = 60;
       else if (glassType.includes('1/2')) shapeMin = 70;
 
       if (shapeMin > 0 && eachPrice < shapeMin) eachPrice = shapeMin;
     }
 let total = eachPrice * qty;
 
     row.querySelector('.eachPrice').innerText = `$${eachPrice.toFixed(2)}`;
     row.querySelector('.lineTotal').innerText = `$${total.toFixed(2)}`;
 
     grandTotal += total;
   });
 
   document.getElementById('grandTotal').innerText =
     `Grand Total: $${grandTotal.toFixed(2)}`;
   document.getElementById('grandTotalTax').innerText =
     `Grand Total with Tax (6%): $${(grandTotal * 1.06).toFixed(2)}`;
 }
 
 function clearForm() {
   startNewOrder();
 }
 
-function showHardwareList() {
-  const list = document.getElementById('hardwareList');
-  const search = document.getElementById('hardwareSearch').value.toLowerCase();
-  list.innerHTML = '';
-  Object.keys(hardwareParts).forEach(part => {
-    if (part.toLowerCase().includes(search)) {
-      const li = document.createElement('li');
-      li.textContent = part;
-      li.onclick = () => {
-        document.getElementById('hardwareSearch').value = part;
-        document.getElementById('hardwarePrice').innerText =
-          `Hardware Price: $${hardwareParts[part].toFixed(2)}`;
-        hideHardwareList();
-      };
-
-      list.appendChild(li);
-    }
-  });
-  list.style.display = 'block';
+function refreshHardwareDatalist() {
+  const datalist = document.getElementById('hardwarePartsList');
+  if (!datalist) return;
+  datalist.innerHTML = Object.keys(hardwareParts)
+    .sort((a,b) => a.localeCompare(b))
+    .map(part => `<option value="${escapeHtml(part)}"></option>`)
+    .join('');
 }
 
-function hideHardwareList() {
-  document.getElementById('hardwareList').style.display = 'none';
+function updateHardwareRow(row) {
+  const qtyEl = row.querySelector('.hw-qty');
+  const partEl = row.querySelector('.hw-part');
+  const priceEl = row.querySelector('.hw-price');
+  const totalEl = row.querySelector('.hw-total');
+
+  const qty = Math.max(0, parseInt(qtyEl?.value, 10) || 0);
+  if (qtyEl && String(qtyEl.value) !== String(qty)) qtyEl.value = qty;
+
+  const partName = (partEl?.value || '').trim();
+  const unitPrice = hardwareParts[partName] || 0;
+  const lineTotal = unitPrice * qty;
+
+  if (priceEl) priceEl.innerText = `$${unitPrice.toFixed(2)}`;
+  if (totalEl) totalEl.innerText = `$${lineTotal.toFixed(2)}`;
 }
-function clearHardware() {
-  document.getElementById('hardwareSearch').value = '';
-  document.getElementById('hardwareList').innerHTML = '';
-  document.getElementById('hardwarePrice').innerText = 'Hardware Price: $0.00';
+
+function updateHardwareTotals() {
+  const rows = document.querySelectorAll('#hardwareTableBody tr');
+  let hardwareTotal = 0;
+  rows.forEach(row => {
+    const totalText = row.querySelector('.hw-total')?.innerText || '$0.00';
+    const match = totalText.match(/\$([\d,.]+)/);
+    if (match) hardwareTotal += parseFloat(match[1].replace(/,/g, '')) || 0;
+  });
+
+  const totalEl = document.getElementById('hardwareGrandTotal');
+  if (totalEl) totalEl.innerText = `Hardware Total: $${hardwareTotal.toFixed(2)}`;
 }
 
-function toggleHardwareList() {
-  const list = document.getElementById('hardwareList');
-  if (list.style.display === 'block') {
-    hideHardwareList();
-  } else {
-    showHardwareList();
-  }
+function clearHardware() {
+  document.querySelectorAll('#hardwareTableBody tr').forEach(row => {
+    const qtyEl = row.querySelector('.hw-qty');
+    const partEl = row.querySelector('.hw-part');
+    if (qtyEl) qtyEl.value = 0;
+    if (partEl) partEl.value = '';
+    row.querySelector('.hw-price').innerText = '$0.00';
+    row.querySelector('.hw-total').innerText = '$0.00';
+  });
+  updateHardwareTotals();
 }
 
 // ===================== TAB SWITCHING =====================
 function switchTab(tab) {
   const calcSection = document.getElementById('calculator-section');
   const custSection = document.getElementById('customer-section');
   const ordSection = document.getElementById('orders-section');
   const tabCalc = document.getElementById('tabCalculator');
   const tabCust = document.getElementById('tabCustomers');
   const tabOrd = document.getElementById('tabOrders');
 
   // Hide all
   calcSection.classList.add('hidden');
   custSection.classList.remove('active');
   ordSection.classList.remove('active');
   tabCalc.classList.remove('active');
   tabCust.classList.remove('active');
   tabOrd.classList.remove('active');
 
   if (tab === 'customers') {
     custSection.classList.add('active');
     tabCust.classList.add('active');
     loadCustomers();
   } else if (tab === 'orders') {
     ordSection.classList.add('active');
@@ -2382,68 +2347,82 @@ function gatherOrderData() {
   };
   if (selectedCalcCustomer) {
     customer.customerId = selectedCalcCustomer.id;
   }
 
   // Gather glass line items
   const items = [];
   const rows = document.querySelectorAll('#glassTableBody tr');
   rows.forEach(row => {
     const glassType = row.querySelector('.glassTypeInput')?.value || '';
     if (!glassType.trim()) return; // skip empty rows
 
     items.push({
       qty: parseInt(row.querySelector('.qty')?.value) || 1,
       width: row.querySelector('.width')?.value || '',
       height: row.querySelector('.height')?.value || '',
       glassType: glassType,
       bevel: row.querySelector('.bevel')?.checked || false,
       bevelWidth: row.querySelector('.bevelWidth')?.value || '1/2',
       shape: row.querySelector('.shape')?.checked || false,
       eachPrice: row.querySelector('.eachPrice')?.innerText || '$0.00',
       lineTotal: row.querySelector('.lineTotal')?.innerText || '$0.00',
     });
   });
 
-  // Gather hardware
-  const hwName = document.getElementById('hardwareSearch').value.trim();
-  const hwPriceText = document.getElementById('hardwarePrice').innerText;
-  const hwMatch = hwPriceText.match(/\$([\d.]+)/);
-  const hwPrice = hwMatch ? parseFloat(hwMatch[1]) : 0;
-  const hardware = hwName ? { name: hwName, price: hwPrice } : null;
+  // Gather hardware rows
+  const hardwareItems = Array.from(document.querySelectorAll('#hardwareTableBody tr')).map(row => {
+    const qty = parseInt(row.querySelector('.hw-qty')?.value, 10) || 0;
+    const name = (row.querySelector('.hw-part')?.value || '').trim();
+    const unitPriceText = row.querySelector('.hw-price')?.innerText || '$0.00';
+    const lineTotalText = row.querySelector('.hw-total')?.innerText || '$0.00';
+    const unitMatch = unitPriceText.match(/\$([\d.]+)/);
+    const lineMatch = lineTotalText.match(/\$([\d.]+)/);
+    return {
+      qty,
+      name,
+      price: unitMatch ? parseFloat(unitMatch[1]) : 0,
+      total: lineMatch ? parseFloat(lineMatch[1]) : 0,
+    };
+  }).filter(item => item.qty > 0 && item.name);
+
+  const hardwareTotal = hardwareItems.reduce((sum, item) => sum + item.total, 0);
+  const hardware = hardwareItems.length
+    ? { name: hardwareItems.length === 1 ? hardwareItems[0].name : 'Multiple hardware items', price: hardwareTotal }
+    : null;
 
   // Totals
   const grandTotalText = document.getElementById('grandTotal').innerText;
   const grandTotalTaxText = document.getElementById('grandTotalTax').innerText;
   const gtMatch = grandTotalText.match(/\$([\d,.]+)/);
   const gttMatch = grandTotalTaxText.match(/\$([\d,.]+)/);
   const grandTotal = gtMatch ? parseFloat(gtMatch[1].replace(/,/g, '')) : 0;
   const grandTotalWithTax = gttMatch ? parseFloat(gttMatch[1].replace(/,/g, '')) : 0;
 
   const specialPricing = document.getElementById('specialPricingToggle').checked;
 
-  return { customer, items, hardware, specialPricing, grandTotal, grandTotalWithTax };
+  return { customer, items, hardware, hardwareItems, specialPricing, grandTotal, grandTotalWithTax };
 }
 
 async function saveOrder() {
   const data = gatherOrderData();
 
   if (!data.customer.name) {
     alert('Please enter a customer name before saving the order.');
     return;
   }
 
   if (data.items.length === 0) {
     alert('Please add at least one glass line item before saving the order.');
     return;
   }
 
   const saveBtn = document.querySelector('.btn-save-order');
   saveBtn.disabled = true;
   saveBtn.textContent = 'Saving...';
 
   try {
     const res = await fetch('/api/orders', {
       method: 'POST',
       headers: { 'Content-Type': 'application/json' },
       body: JSON.stringify(data),
     });
@@ -2727,56 +2706,69 @@ function populateCalculatorFromOrder(order) {
   // Clear and rebuild glass rows
   document.getElementById('glassTableBody').innerHTML = '';
   const items = order.items || [];
 
   if (items.length === 0) {
     for (let i = 0; i < 5; i++) addRow();
   } else {
     items.forEach(item => {
       addRow();
       const rows = document.querySelectorAll('#glassTableBody tr');
       const row = rows[rows.length - 1];
 
       row.querySelector('.qty').value = item.qty || 1;
       row.querySelector('.width').value = item.width || '';
       row.querySelector('.height').value = item.height || '';
       row.querySelector('.glassTypeInput').value = item.glassType || '';
       row.querySelector('.bevel').checked = item.bevel || false;
       row.querySelector('.bevelWidth').value = item.bevelWidth || '1/2';
       row.querySelector('.shape').checked = item.shape || false;
     });
     // Add a few blank rows at the end
     for (let i = 0; i < 2; i++) addRow();
   }
 
   // Set hardware
-  if (order.hardware && order.hardware.name) {
-    document.getElementById('hardwareSearch').value = order.hardware.name;
-    document.getElementById('hardwarePrice').innerText =
-      `Hardware Price: $${(order.hardware.price || 0).toFixed(2)}`;
-  } else {
-    clearHardware();
+  clearHardware();
+  const savedHardwareItems = Array.isArray(order.hardwareItems) ? order.hardwareItems : [];
+  if (savedHardwareItems.length) {
+    const rows = document.querySelectorAll('#hardwareTableBody tr');
+    savedHardwareItems.slice(0, rows.length).forEach((item, idx) => {
+      const row = rows[idx];
+      row.querySelector('.hw-qty').value = item.qty || 0;
+      row.querySelector('.hw-part').value = item.name || '';
+      updateHardwareRow(row);
+    });
+    updateHardwareTotals();
+  } else if (order.hardware && order.hardware.name) {
+    const firstRow = document.querySelector('#hardwareTableBody tr');
+    if (firstRow) {
+      firstRow.querySelector('.hw-qty').value = 1;
+      firstRow.querySelector('.hw-part').value = order.hardware.name;
+      updateHardwareRow(firstRow);
+      updateHardwareTotals();
+    }
   }
 
   updateTotals();
 }
 
 // ===================== CSV/EXCEL IMPORT =====================
 let importParsedRows = []; // raw parsed rows (array of arrays)
 let importHeaders = [];    // first row (column headers)
 
 function handleImportFile(event) {
   const file = event.target.files[0];
   if (!file) return;
   event.target.value = ''; // reset so same file can be re-selected
 
   const ext = file.name.split('.').pop().toLowerCase();
 
   if (ext === 'csv') {
     const reader = new FileReader();
     reader.onload = function(e) {
       const rows = parseCsv(e.target.result);
       if (rows.length < 2) {
         alert('The CSV file appears to be empty or has no data rows.');
         return;
       }
       importHeaders = rows[0];
@@ -3007,210 +2999,203 @@ async function confirmImport() {
 
 // ===================== STARTUP =====================
 document.addEventListener("DOMContentLoaded", async function () {
   const specialToggle = document.getElementById('specialPricingToggle');
   specialToggle.checked = false;
 
   // Load pricing tables from Google Sheets (Glass + Hardware)
   await loadPricingFromSheets();
 
   // Set the active table (standard by default)
   glassPartsData = standardglassPartsData;
 
   for (let i = 0; i < 5; i++) addRow();
   updateTotals();
 
   // Load customers for autocomplete in calculator
   await loadCalcCustomers();
   setupCustomerLookup();
 });
 </script>
 
 <script>
   function kympgToggleSidebar(){
     document.getElementById('kympgSidebar')?.classList.toggle('collapsed');
   }
+
   function kympgClearActiveNav(){
     document.querySelectorAll('.kympg-navBtn').forEach(b => b.classList.remove('active'));
   }
+
   function kympgHideAllSections(){
     const ids = ['landing-section','calculator-section','customer-section','orders-section',
                  'quotedb-section','po-section','breakage-section','pricelist-section'];
     ids.forEach(id => {
       const el = document.getElementById(id);
       if (!el) return;
       el.style.display = 'none';
       el.classList.remove('active');
     });
   }
+
   function kympgSetHeader(title, sub, cardTitle, cardSub){
     const t = document.getElementById('kympgPageTitle');
     const s = document.getElementById('kympgPageSub');
     const ct = document.getElementById('kympgCardTitle');
     const cs = document.getElementById('kympgCardSub');
     if (t) t.textContent = title || '';
     if (s) s.textContent = sub || '';
     if (ct) ct.textContent = cardTitle || '';
     if (cs) cs.textContent = cardSub || '';
   }
+
   function kympgShowLanding(){
     kympgClearActiveNav();
     kympgHideAllSections();
     const el = document.getElementById('landing-section');
-    if (el){ el.style.display = 'block'; el.classList.add('active'); }
-    kympgSetHeader('Kentucky Mirror and Plate Glass', 'Select an option on the left to get started.', 'Home', 'Welcome');
+    if (el){
+      el.style.display = 'block';
+      el.classList.add('active');
+    }
+    kympgSetHeader(
+      'Kentucky Mirror and Plate Glass',
+      'Select an option on the left to get started.',
+      'Home',
+      'Welcome'
+    );
   }
-  async function loadPurchaseOrders() {
-  try {
-    const res = await fetch('/.netlify/functions/purchase-orders');
-    if (!res.ok) throw new Error('Failed to load Purchase Orders');
 
-    const data = await res.json();
-
-    const container = document.getElementById('po-section');
+  async function loadPurchaseOrders(){
+    try {
+      const res = await fetch('/.netlify/functions/purchase-orders');
+      if (!res.ok) throw new Error('Failed to load Purchase Orders');
 
-    // Clear existing content
-    container.innerHTML = '<h2>Purchase Orders</h2>';
+      const data = await res.json();
+      const container = document.getElementById('po-section');
+      if (!container) return;
 
-    if (!data || data.length === 0) {
-      container.innerHTML += '<p>No purchase orders found.</p>';
-      return;
-    }
+      container.innerHTML = '<h2>Purchase Orders</h2>';
 
-    const table = document.createElement('table');
-    table.style.width = '100%';
-    table.style.borderCollapse = 'collapse';
+      if (!data || data.length === 0) {
+        container.innerHTML += '<p>No purchase orders found.</p>';
+        return;
+      }
 
-    table.innerHTML = `
-      <thead>
-        <tr>
-          <th>PO #</th>
-          <th>Vendor</th>
-          <th>Date</th>
-          <th>Total</th>
-        </tr>
-      </thead>
-      <tbody>
-        ${data.map(po => `
+      const table = document.createElement('table');
+      table.style.width = '100%';
+      table.style.borderCollapse = 'collapse';
+      table.innerHTML = `
+        <thead>
           <tr>
-            <td>${po.poNumber || ''}</td>
-            <td>${po.vendor || ''}</td>
-            <td>${po.date || ''}</td>
-            <td>${po.total || ''}</td>
+            <th>PO #</th>
+            <th>Vendor</th>
+            <th>Date</th>
+            <th>Total</th>
           </tr>
-        `).join('')}
-      </tbody>
-    `;
- if (which === 'customerimport'){
-      const c = document.getElementById('customer-section');
-      if (c){ c.style.display = 'block'; }
-      kympgSetHeader('Customer Import', 'Upload and manage customer records.', 'Customer Import', 'Customer tools');
-      try{ if (typeof loadCustomers === 'function') loadCustomers(); }catch(e){}
-      return;
-    }
-    kympgShowLanding();
-  }
+        </thead>
+        <tbody>
+          ${data.map(po => `
+            <tr>
+              <td>${po.poNumber || ''}</td>
+              <td>${po.vendor || ''}</td>
+              <td>${po.date || ''}</td>
+              <td>${po.total || ''}</td>
+            </tr>
+          `).join('')}
+        </tbody>
+      `;
+      container.appendChild(table);
 
-  window.addEventListener('DOMContentLoaded', () => {
-    const content = document.getElementById('kympgContentArea');
-    if (content){
-      ['calculator-section','customer-section','orders-section'].forEach(id => {
-        const el = document.getElementById(id);
-        if (el && el.parentElement !== content){
-          content.appendChild(el);
-        }
-        if (el) el.style.display = 'none';
-      });
+    } catch (err) {
+      console.error(err);
+      const container = document.getElementById('po-section');
+      if (container) {
+        container.innerHTML = '<p style="color:red;">Error loading purchase orders.</p>';
+      }
     }
-    kympgShowLanding();
-  });
-</script>
-
-</body>
-</html>
-    container.appendChild(table);
-
-  } catch (err) {
-    console.error(err);
-    document.getElementById('po-section').innerHTML =
-      '<p style="color:red;">Error loading purchase orders.</p>';
   }
-}
+
   function kympgOpen(which, btn){
     if (btn){
       kympgClearActiveNav();
       btn.classList.add('active');
     }
     kympgHideAllSections();
 
     if (which === 'quote'){
       const calc = document.getElementById('calculator-section');
-      if (calc){ calc.style.display = 'block'; }
+      if (calc) calc.style.display = 'block';
       kympgSetHeader('New Quote', 'Create and print a quote.', 'New Quote', 'Quote builder');
       return;
     }
+
     if (which === 'order'){
       const calc = document.getElementById('calculator-section');
-      if (calc){ calc.style.display = 'block'; }
+      if (calc) calc.style.display = 'block';
       kympgSetHeader('New Order', 'Create an order and print ticket/invoice.', 'New Order', 'Order form');
-      try{ if (typeof startNewOrder === 'function') startNewOrder(); }catch(e){}
+      try { if (typeof startNewOrder === 'function') startNewOrder(); } catch(e) {}
       return;
     }
+
     if (which === 'orders'){
       const ord = document.getElementById('orders-section');
-      if (ord){ ord.style.display = 'block'; }
+      if (ord) ord.style.display = 'block';
       kympgSetHeader('Search / Open Orders', 'Find and open past orders.', 'Orders', 'Search and open orders');
-      try{ if (typeof loadOrders === 'function') loadOrders(); }catch(e){}
+      try { if (typeof loadOrders === 'function') loadOrders(); } catch(e) {}
       return;
     }
+
     if (which === 'quotedb'){
       const q = document.getElementById('quotedb-section');
-      if (q){ q.style.display = 'block'; }
+      if (q) q.style.display = 'block';
       kympgSetHeader('Open Quotes', 'Search and open saved quotes.', 'Quotes', 'Quotes database');
       return;
     }
-  if (which === 'po') {
-  const p = document.getElementById('po-section');
-  if (p){ p.style.display = 'block'; }
 
-  kympgSetHeader(
-    'Purchase Orders',
-    'Track vendor purchase orders.',
-    'Purchase Orders',
-    'Vendor POs'
-  );
+    if (which === 'po'){
+      const p = document.getElementById('po-section');
+      if (p) p.style.display = 'block';
+      kympgSetHeader('Purchase Orders', 'Track vendor purchase orders.', 'Purchase Orders', 'Vendor POs');
+      loadPurchaseOrders();
+      return;
+    }
 
-  loadPurchaseOrders();   // ‚Üê THIS LINE loads the database
-  return;
-}
     if (which === 'breakage'){
       const b = document.getElementById('breakage-section');
-      if (b){ b.style.display = 'block'; }
+      if (b) b.style.display = 'block';
       kympgSetHeader('Breakage Pricing', 'Open the breakage calculator inside the app.', 'Breakage Pricing', 'Tool');
       return;
     }
+
     if (which === 'pricelist'){
       const p = document.getElementById('pricelist-section');
-      if (p){ p.style.display = 'block'; }
+      if (p) p.style.display = 'block';
       kympgSetHeader('Sq Ft Price List', 'Reference pricing inside the app.', 'Sq Ft Price List', 'Tool');
       return;
     }
+
+    if (which === 'customerimport'){
+      const c = document.getElementById('customer-section');
+      if (c) c.style.display = 'block';
+      kympgSetHeader('Customer Import', 'Upload and manage customer records.', 'Customer Import', 'Customer tools');
+      try { if (typeof loadCustomers === 'function') loadCustomers(); } catch(e) {}
+      return;
+    }
+
     kympgShowLanding();
   }
 
   window.addEventListener('DOMContentLoaded', () => {
     const content = document.getElementById('kympgContentArea');
     if (content){
       ['calculator-section','customer-section','orders-section'].forEach(id => {
         const el = document.getElementById(id);
-        if (el && el.parentElement !== content){
-          content.appendChild(el);
-        }
+        if (el && el.parentElement !== content) content.appendChild(el);
         if (el) el.style.display = 'none';
       });
     }
     kympgShowLanding();
   });
 </script>
 
 </body>
 </html>
